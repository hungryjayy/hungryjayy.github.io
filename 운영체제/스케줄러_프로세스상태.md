# 프로세스 상태변화와 스케줄러



## 프로세스 상태변화

<img src="https://t1.daumcdn.net/cfile/tistory/276F904A595DCF4F23" alt="img" style="zoom:150%;" /> 

*출처: https://blockdmask.tistory.com/22*

위 그림에서 blocked == waiting



* `new -> ready` : 장기 스케줄러에 의해 Ready Queue에 올라감
* `ready -> running` : 단기 스케줄러에 의해 CPU에 할당된 상태.
* `running -> ready` : 다른 프로세스에 의해 선점당하면 다시 ready Queue로.
  * 스케줄링 알고리즘이 우선순위 스케줄링인 경우
* `running -> waiting` : 입출력(I/O) 이벤트 발생시 block
* `waiting -> ready` : 입출력(I/O) 이벤트 종료 시 다시 Ready
* `running -> terminate` : 프로세스 종료



#### `ready`, `waiting` 상태에는 여러 프로세스 존재할 수 있으나, 싱글 코어CPU라고 가정했을 때 `running` 상태의 프로세스는 단 하나 존재



#### 이외에도, `suspend`라는 state가 있다.

* 중기 스케줄러에 의해 디스크로 swap out 된 상태
* `waiting(blocked)` 상태는 I/O 작업을 기다리는 상태이기 때문에 스스로 `ready` 상태로 돌아가지만, `suspend`는 다른 이유로 직접 swap된 것이기 때문에 스스로 `ready`가 되지 못한다.





## 스케줄링

: 프로세스에게 CPU 등의 자원을 적절히 배정하는 것



### Queue: 프로세스 스케줄링에 사용되는 큐

* Job Queue: 현재 시스템 내의 **모든 프로세스** 집합
* Ready Queue: 현재 **메모리 내**에 있고, CPU 할당을 **기다리고 있는** 프로세스 집합 
* Device Queue: **Device I/O** 작업을 대기하고 있는 프로세스 집합



### 장기 스케줄러

: 어떤 프로세스를 Ready Queue(메모리)로 보낼지 결정. swap-in

* **메모리**와 **디스크** 사이 스케줄링
  * 일단 많은 프로세스가 한번에 올라오면, 대용량 메모리(디스크)에 임시로 저장되고, 이걸 적절히 메모리로 올려야 함.
  * 메모리는 한정되어있기 때문에 적절한 스케줄링 필요
* 실행중인 프로세스 수 제어하는 역할(degree of Multi-programming)
* `new -> ready`



### 단기 스케줄러

: 어떤 프로세스를 실행할지(Running) 결정. 따라서, 프로세스에 CPU 를 할당(scheduler dispatch)

* CPU 와 메모리 사이 스케줄링
* Ready Queue에 존재하는 프로세스 중 어떤 프로세스를 running 시킬지
* `ready -> running -> waiting -> ready`



### 중기 스케줄러

: 어떤 프로세스를 메모리에서 디스크로 쫓아낼지 결정

* 메모리 공간 확보를 위해 디스크로 swap-out
  * 프로세스에게서 memory를 deallocate
* 실행중인 프로세스 수 제어하는 역할(degree of Multi-programming)
* `ready -> suspended`



* 대부분의 OS에서는 **우선순위 알고리즘**이나 **Round Robin** 혼합해서 사용한다고 함



#### Reference)

#### https://blockdmask.tistory.com/22

#### https://github.com/JaeYeopHan/Interview_Question_for_Beginner/tree/master/OS#cpu-%EC%8A%A4%EC%BC%80%EC%A4%84%EB%9F%AC