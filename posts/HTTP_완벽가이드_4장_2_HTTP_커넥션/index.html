<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="HTTP 완벽가이드 4장 - 2. HTTP 커넥션" /><meta name="author" content="hungryjayy" /><meta property="og:locale" content="en" /><meta name="description" content="A minimal, portfolio, sidebar, bootstrap Jekyll theme with responsive web design and focuses on text presentation." /><meta property="og:description" content="A minimal, portfolio, sidebar, bootstrap Jekyll theme with responsive web design and focuses on text presentation." /><link rel="canonical" href="https://hungryjayy.github.io/posts/HTTP_%EC%99%84%EB%B2%BD%EA%B0%80%EC%9D%B4%EB%93%9C_4%EC%9E%A5_2_HTTP_%EC%BB%A4%EB%84%A5%EC%85%98/" /><meta property="og:url" content="https://hungryjayy.github.io/posts/HTTP_%EC%99%84%EB%B2%BD%EA%B0%80%EC%9D%B4%EB%93%9C_4%EC%9E%A5_2_HTTP_%EC%BB%A4%EB%84%A5%EC%85%98/" /><meta property="og:site_name" content="hungryjayy" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-07-23T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="HTTP 완벽가이드 4장 - 2. HTTP 커넥션" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"hungryjayy"},"dateModified":"2021-07-23T00:00:00+09:00","datePublished":"2021-07-23T00:00:00+09:00","description":"A minimal, portfolio, sidebar, bootstrap Jekyll theme with responsive web design and focuses on text presentation.","headline":"HTTP 완벽가이드 4장 - 2. HTTP 커넥션","mainEntityOfPage":{"@type":"WebPage","@id":"https://hungryjayy.github.io/posts/HTTP_%EC%99%84%EB%B2%BD%EA%B0%80%EC%9D%B4%EB%93%9C_4%EC%9E%A5_2_HTTP_%EC%BB%A4%EB%84%A5%EC%85%98/"},"url":"https://hungryjayy.github.io/posts/HTTP_%EC%99%84%EB%B2%BD%EA%B0%80%EC%9D%B4%EB%93%9C_4%EC%9E%A5_2_HTTP_%EC%BB%A4%EB%84%A5%EC%85%98/"}</script><title>HTTP 완벽가이드 4장 - 2. HTTP 커넥션 | hungryjayy</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="hungryjayy"><meta name="application-name" content="hungryjayy"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/Profile/cat.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">hungryjayy</a></div><div class="site-subtitle font-italic">기억하려고 기록하기</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/hungryjayy" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://instagram.com/" aria-label="instagram" target="_blank" rel="noopener"> <i class="fab fa-instagram"></i> </a> <a href="https://www.linkedin.com/in/joowon-son-557206226/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['juwon9331','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div style="text-align: center;"> <a href="https://hits.seeyoufarm.com"> <img alt="alt" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fhungryjayy.github.io&count_bg=%23121312&title_bg=%23000000&icon=&icon_color=%23ACACAC&title=hits&edge_flat=false"/> </a></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>HTTP 완벽가이드 4장 - 2. HTTP 커넥션</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HTTP 완벽가이드 4장 - 2. HTTP 커넥션</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/hungryjayy">hungryjayy</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2021-07-23 00:00:00 +0900" data-toggle="tooltip" data-placement="bottom" title="Fri, Jul 23, 2021, 12:00 AM +0900" >Jul 23, 2021</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2351 words"> <em>13 min</em> read</span></div></div></div><div class="post-content"><p><br /></p><h3 id="connection-헤더란">Connection 헤더란? <a href="#connection-헤더란" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li><p><strong>헤더 보호하기</strong> : 한 Connection 작업에서만 사용되어야 하는 <strong>토큰 값</strong>들을 쉼표로 구분해 갖고 있는다.</p><ul><li><p>다른 커넥션(다른 홉)에 전달되는 것 방지</p><div class="language-http highlighter-rouge"><div class="code-header"> <span data-label-text="Http"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Cache-control</span><span class="p">:</span> <span class="s">max-age=3600</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">meter, close, bill-my-credit-card</span>
</pre></table></code></div></div><ul><li>위의 메시지에서 <code class="language-plaintext highlighter-rouge">Connection:</code> 부분에 명시한 것</ul></ul><li><p><strong>Hop-by-Hop</strong>: 두 홉(노드) 사이에서만 전달되고 그 이후엔 없어져야 한다.(클라 - 프락시 or 프락시 - 서버 등)</p></ul><p><br /></p><h2 id="병렬-커넥션">병렬 커넥션 <a href="#병렬-커넥션" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>: HTTP 클라이언트가 여러 개의 TCP 커넥션을 맺어 HTTP 트랜잭션을 병렬로 처리할 수 있게 한다.</p><ul><li>클라이언트 입장에서의 <strong>객체당 한 서버</strong>와 커넥션을 맺어 <strong>각 커넥션의 지연시간을 겹치게 해</strong> 처리 속도를 빠르게 하는 것</ul><h4 id="항상-빠르지는-않다">항상 빠르지는 않다. <a href="#항상-빠르지는-않다" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><ol><li>대역폭이 좁으면 각 객체를 전송하는게 느리기 때문에 성능상 장점이 없다.<li>실제로 연결하는 <strong>병렬 커넥션 수에는 제한</strong>이 있다. (커넥션을 늘릴 수록 성능 문제)<ul><li>한 사용자 당 100개의 커넥션을 허용하고 100명의 사용자가 사용하면 서버는 10000개의 커넥션을 맺어야 하는데, 이 것은 <strong>큰 부하</strong>가 될 수 있다.<li>따라서, <strong>최신 브라우저는 대부분 6~8</strong>개 라고 함</ul><li>연결을 맺고 끊음을 반복하다보니 <strong>TCP의 느린 시작</strong>을 피할 수 없다.</ol><p><br /></p><h2 id="지속-커넥션">지속 커넥션 <a href="#지속-커넥션" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>: HTTP 트랜잭션이 처리된 이후에도 커넥션을 끊지 않고 재사용하는 것</p><ul><li><strong>사이트 지역성</strong>(site locality): 서버에 HTTP 요청을 하기 시작한 애플리케이션은 웹 페이지 내의 이미지 등을 가져오기 위해 <strong>그 서버에 또 요청을 할 것</strong><li><strong>커넥션을 맺기위한 준비작업</strong>을 줄일 수 있고, <strong>TCP 느린 시작</strong>으로 인한 지연을 피할 수 있다.<ul><li><strong>튜닝된 커넥션</strong> : 느린시작에서 수차례 성공해서 다수의 패킷을 전송할 권한을 얻은 상태</ul><li><strong>HTTP/1.0의 Keep-Alive</strong>, <strong>HTTP/1.1의 지속 커넥션</strong><li>지속적으로 커넥션을 유지하는 상황이더라도, 양 측에선 언제건 끊을 수 있긴 하다.</ul><p><br /></p><h3 id="http10의-keep-alive-커넥션">HTTP/1.0의 Keep-alive 커넥션 <a href="#http10의-keep-alive-커넥션" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>TCP 핸드셰이크와 느린시작으로 인한 지연을 줄인다.<li>Keep-alive가 HTTP/1.1에서 사용하지 않도록 되어 빠졌지만, 많은 브라우저에서 <strong>여전히 Keep-alive를 사용</strong>하기 때문에 개발자는 keep-alive가 가능하도록 개발해야 한다.<li><code class="language-plaintext highlighter-rouge">Connection:Keep-Alive</code> 헤더<ul><li><strong>요청</strong>에 <code class="language-plaintext highlighter-rouge">Connection:Keep-Alive</code> 헤더 : “이 방식으로 통신하고 싶다” 의미<li><strong>응답</strong>에 <code class="language-plaintext highlighter-rouge">Connection:Keep-Alive</code> 헤더 : “이 방식을 지원할 것”(없다면 연결 끊을 것임을 의미)<li>HTTP/1.0을 따르는 기기로부터 받는 모든 Connection 헤더 필드(<code class="language-plaintext highlighter-rouge">Connection: Keep-Alive</code>와 같은)는 무시되어야 한다.<ul><li><strong>멍청한 프락시</strong>: <strong>오래된 프락시</strong>로 전달해서 <strong>Hang</strong> 걸릴 수 있기 때문</ul><li>이 방식을 사용하려면 정확한 <code class="language-plaintext highlighter-rouge">Content-Length</code> 값이 있어야 한다. 기존 메시지 끝과 새로운 메시지 시작점을 정확히 알수 어렵기 떄문</ul></ul><p><br /></p><h3 id="keep-alive와-멍청한-프락시dumb-proxy">Keep-alive와 멍청한 프락시(Dumb Proxy) <a href="#keep-alive와-멍청한-프락시dumb-proxy" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li><p>오래된 프락시들은 <code class="language-plaintext highlighter-rouge">Connection:Keep-Alive</code> 헤더를 해석하지 못하고 <strong>그대로 전달한다.</strong></p><li><p><strong><code class="language-plaintext highlighter-rouge">Connection</code> 헤더는 기본적으로 홉별(Hop-by-Hop) 헤더이기 때문에 한개의 전송 링크에만 적용되며 다음 서버로 전송되면 안된다.</strong></p><p><img data-src="https://hungryjayy.github.io/assets/img/Http/dump_proxy.png" style="zoom: 20%;" data-proofer-ignore></p><ul><li>a에서의 <code class="language-plaintext highlighter-rouge">Connection:Keep-Alive</code> 는 b까지 전파되지 않아야 하는데, 멍청한 프락시 문제로 서버에선 proxy가 커넥션을 유지하자고 요청하는 것으로 잘못 판단하게 된다.<li><strong>프락시는 서버가 커넥션을 끊기를 기다리지만</strong> 서버는 프락시가 Keep-alive를 요청한 것으로 알기때문에 끊지 않는다.<li>클라이언트가 유지하고 있는 커넥션으로 요청을 보내면 <strong>같은 커넥션 상 다른 요청이 오는 경우를 예상하지 못하기 때문에 무시</strong>해버린다.</ul><li><p><strong>해결방안 1</strong> : Proxy는<code class="language-plaintext highlighter-rouge">Connection: Keep-Alive</code> 헤더를 전달하면 안되고, 당연히 <code class="language-plaintext highlighter-rouge">Keep-Alive: ~~ </code> 와 같은 <code class="language-plaintext highlighter-rouge">Keep-Alive</code> 헤더도 전달하면 안된다.</p><ul><li>같은 이유로, <strong>Proxy는 다른 홉별(Hop by Hop) 헤더를 전달 혹은 캐싱하면 안된다.</strong></ul><li><p><strong>해결방안 2</strong>: 프락시에 커넥션 관련 메시지를 보낼 때는<code class="language-plaintext highlighter-rouge">Proxy-Connection</code> 이라는 확장 헤더를 사용</p><ul><li>오래된 프락시는 이 것을 똑같이 <strong>무조건 전달</strong>해도, <strong>서버에선 뭔지 모르니</strong> 괜찮다.<li>영리한 프락시는 이 것을 <code class="language-plaintext highlighter-rouge">Connection</code> 헤더로 바꾸고 요청한 의도대로 동작할 것<li>그러나, 멍청한 프락시가 중간에 하나라도 끼어있다면 다시 문제가 발생한다.</ul><li><p>프락시의 경우 <strong>보이지 않는 경우</strong>가 많기 때문에 지속 커넥션을 명확히 구현하는 것이 중요하다.</p></ul><p><br /></p><h3 id="http11의-지속-커넥션">HTTP/1.1의 지속 커넥션 <a href="#http11의-지속-커넥션" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>디폴트로 활성화 되어있고, 커넥션을 끊으려면 <code class="language-plaintext highlighter-rouge">Connection: close</code> 헤더를 명시하는 방식으로 사용<li>마찬가지로 정확한 <code class="language-plaintext highlighter-rouge">Content-Length</code> 필요<li>HTTP/1.1 프락시는 클라이언트, 서버 양측 별도의 지속 커넥션을 맺고 관리해야한다.<li>HTTP/1.1 애플리케이션은 중간에 끊어지는 커넥션을 복구할 수 있어야 한다. 이 때 클라이언트는 언제든 재요청 할 준비를 해야 한다.<li>클라이언트는 과부하 방지를 위해 넉넉잡아 두개의 지속 커넥션만 유지해야한다.</ul><p><br /></p><h2 id="파이프라인-커넥션">파이프라인 커넥션 <a href="#파이프라인-커넥션" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>: 지속 커넥션을 통해 요청을 파이프라이닝해 keep-alive 효과를 더 높인다.</p><ul><li>요청은 Queue에 쌓여 파이프라인 방식으로 전달된다.<li>지속 커넥션일 때만 파이프라인을 이을 수 있다.<li>순서가 유지되어야 한다.(그런데, 이미 TCP 통신이면 ACK로 순서가 보장이 될 것 같은데 왜 그런지는 모르겠다)<li><strong>끊김에 대한 준비</strong>: 커넥션이 끊어지는 상황에서 클라이언트는 언제든 재요청할 준비가 되어있어야 하는데, 클라이언트는 파이프라인 중 <strong>어느게 성공하고 어느게 실패한지</strong> 알 방법이 없기 때문에 <strong>비멱등 요청</strong>은 파이프라인으로 보내면 안된다.</ul><p><br /></p><h2 id="커넥션-끊기와-관련된-것들">커넥션 끊기와 관련된 것들 <a href="#커넥션-끊기와-관련된-것들" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>: 커넥션 끊는 것에 명확한 기준은 없다.</p><ul><li>마음대로 커넥션 끊기: 메시지를 다 보낸다음 끊는다.<ul><li>e.g) 지속 커넥션에서 일정 timeout 이후에 끊어버리기.(그러나 더이상 필요 없다고 확신은 못함)</ul><li><code class="language-plaintext highlighter-rouge">Content-Length</code>: 정확한 값을 가져야 비교를 통해 끝났는지를 판단할 수 있다. - 없다면 데이터 길이를 서버에게 물어봐야 한다.<li>끊기 허용, 재시도, 멱등성: HTTP 애플리케이션은 커넥션이 끊겼을 때 적절히 대응할 준비가 되어 있어야 한다.<ul><li>파이프라인 커넥션의 경우 더 어려워진다. 위에서 이야기했듯, <strong>비멱등 요청</strong>의 경우 다시 보내기를 피해야한다.<li>해결 예시) 캐시된 Post 요청 페이지를 다시 로드할 때, 요청을 다시 보내기를 원하는지 alert를 띄워준다 등</ul></ul><p><br /></p><h3 id="우아한-커넥션-끊기">우아한 커넥션 끊기 <a href="#우아한-커넥션-끊기" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>TCP커넥션에선 <strong>두 채널(입력 큐와 출력 큐)</strong> 이 존재한다.<ul><li>한쪽의 입력 큐는 반대쪽의 출력 큐가 된다.</ul><li><strong>전체끊기</strong>, <strong>절반끊기</strong> : 두 채널 중 하나만 끊는 것은 <code class="language-plaintext highlighter-rouge">shutdown()</code> 을 통한 <strong>절반 끊기</strong>, 둘다 끊는 것은 <code class="language-plaintext highlighter-rouge">close()</code> 를 통한 <strong>전체 끊기</strong><li>보통은 <strong>출력 채널</strong>을 끊어버리는게 이상적이다. -&gt; 상대방은 받을 것을 다 받고나서 내가 커넥션을 끊었다는 것을 알게 되기 때문<li>만약 <strong>입력 채널을 끊어버리면</strong>? (내 입장에선 출력 채널이 상대방에 의해 끊기면)<ul><li>파이프라인 커넥션 상황에서 계속 요청을 보내다가 상대방이 끊게 되면 어느 순간 <code class="language-plaintext highlighter-rouge">connection rest by peer</code> 메시지를 받게 된다. 이 리셋 메시지는 입력 버퍼에 있는 (아직 읽히지 않은)데이터를 지우게 된다.</ul></ul><h4 id="우아하게-커넥션-끊기">우아하게 커넥션 끊기 <a href="#우아하게-커넥션-끊기" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>: <strong>일반적으로 좋은 방법은 자신의 출력채널을 먼저 끊고 상대방의 출력채널이 끊기기를 기다리는 것.</strong> 만약 timeout 내에 상대방이 끊지 않으면, 나의 리소스 보호를 위해 커넥션을 강제로 끊을 수도 있다.</p><p><br /><br /></p><h4 id="reference">Reference) <a href="#reference" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>HTTP 완벽가이드</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/network/'>Network</a>, <a href='/categories/http/'>HTTP</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/http/" class="post-tag no-text-decoration" >http</a> <a href="/tags/http-connection/" class="post-tag no-text-decoration" >http connection</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HTTP 완벽가이드 4장 - 2. HTTP 커넥션 - hungryjayy&url=https://hungryjayy.github.io/posts/HTTP_%EC%99%84%EB%B2%BD%EA%B0%80%EC%9D%B4%EB%93%9C_4%EC%9E%A5_2_HTTP_%EC%BB%A4%EB%84%A5%EC%85%98/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HTTP 완벽가이드 4장 - 2. HTTP 커넥션 - hungryjayy&u=https://hungryjayy.github.io/posts/HTTP_%EC%99%84%EB%B2%BD%EA%B0%80%EC%9D%B4%EB%93%9C_4%EC%9E%A5_2_HTTP_%EC%BB%A4%EB%84%A5%EC%85%98/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=HTTP 완벽가이드 4장 - 2. HTTP 커넥션 - hungryjayy&url=https://hungryjayy.github.io/posts/HTTP_%EC%99%84%EB%B2%BD%EA%B0%80%EC%9D%B4%EB%93%9C_4%EC%9E%A5_2_HTTP_%EC%BB%A4%EB%84%A5%EC%85%98/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div><script src="https://utteranc.es/client.js" repo="hungryjayy/hungryjayy.github.io" issue-term="pathname" theme="icy-dark" crossorigin="anonymous" async> </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/SQL_injection%EA%B3%BC_prepared_statement/">SQL Injection</a><li><a href="/posts/%ED%8C%8C%EB%9D%BC%EB%AF%B8%ED%84%B0%EC%9D%98_%EC%97%AD%ED%95%A0/">파라미터의 역할</a><li><a href="/posts/%EC%BD%94%EB%93%9C_%EB%A6%AC%EB%B7%B0%ED%95%98%EA%B8%B0/">코드 리뷰하기</a><li><a href="/posts/%EC%8A%A4%ED%82%A4%EB%A7%88/">Database 스키마</a><li><a href="/posts/%EC%A0%95%EA%B7%9C%ED%99%94%EA%B0%80_%ED%95%84%EC%9A%94%ED%95%9C%EC%9D%B4%EC%9C%A0/">DB 정규화가 필요한 이유와 함수적 종속</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/network/">network</a> <a class="post-tag" href="/tags/develop/">develop</a> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/js/">js</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/spring-boot/">spring boot</a> <a class="post-tag" href="/tags/%EB%A6%AC%EB%88%85%EC%8A%A4/">리눅스</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/%EC%8A%A4%ED%94%84%EB%A7%81/">스프링</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/HTTP_%EC%99%84%EB%B2%BD%EA%B0%80%EC%9D%B4%EB%93%9C_4%EC%9E%A5_1_TCP_%EC%BB%A4%EB%84%A5%EC%85%98/"><div class="card-body"> <em class="timeago small" date="2021-07-14 00:00:00 +0900" >Jul 14, 2021</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTTP 완벽가이드 4장 - 1. TCP 커넥션</h3><div class="text-muted small"><p> TCP 커넥션 : 클라이언트와 서버가 TCP 소켓 인터페이스를 사용해 상호작용하는 과정 위쪽(S1~C2) 에서 소켓 열고, 가운데에서(C3, S5, C4) TCP 핸드셰이크, 아랫쪽 실제 통신 HTTP 커넥션은 몇몇 사용 규칙을 제외하고는 TCP 커넥션에 불과하다. TCP는 HTTP에게 신뢰성 있는 통신을 제...</p></div></div></a></div><div class="card"> <a href="/posts/HTTP_%EC%99%84%EB%B2%BD%EA%B0%80%EC%9D%B4%EB%93%9C_5%EC%9E%A5_%EC%9B%B9%EC%84%9C%EB%B2%84%EA%B0%80_%ED%95%98%EB%8A%94%EC%9D%BC/"><div class="card-body"> <em class="timeago small" date="2021-08-01 00:00:00 +0900" >Aug 1, 2021</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTTP 완벽가이드 5장 - 웹 서버가 하는 일</h3><div class="text-muted small"><p> 웹 서버는 목적에 따라 다양하지만, 기본적으로 리소스에 대한 HTTP 요청을 받아 콘텐츠를 클라이언트에게 돌려주는 일을한다. 간단한 일을 처리하는 작은 임베디드 서버(프린터, 가전기기, IoT 등)을 생각해보자 커넥션을 맺고, 요청을 받고, 처리(해석)하고, 리소스에 접근하고, 응답을 만들고 보낸다. ...</p></div></div></a></div><div class="card"> <a href="/posts/HTTPS_SSL/"><div class="card-body"> <em class="timeago small" date="2021-03-23 00:00:00 +0900" >Mar 23, 2021</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTTPS와 SSL</h3><div class="text-muted small"><p> HTTP의 문제점 암호화 하지 않음 - 평문(단순 텍스트)을 주고받음(Http 메시지) GET / HTTP/1.1 Host: developer.mozilla.org Accept-Language: fr 문제점 통신 상대 확인하지 않음 - Client, serve...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/%EB%AA%A8%EB%8D%98_Javascript_%ED%8A%9C%ED%86%A0%EB%A6%AC%EC%96%BC_use_strict/" class="btn btn-outline-primary" prompt="Older"><p>모던 JavaScript 튜토리얼 - 'use strict'</p></a> <a href="/posts/SQL_injection%EA%B3%BC_prepared_statement/" class="btn btn-outline-primary" prompt="Newer"><p>SQL Injection</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/hungryjayy">Joowon Son</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/network/">network</a> <a class="post-tag" href="/tags/develop/">develop</a> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/js/">js</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/spring-boot/">spring boot</a> <a class="post-tag" href="/tags/%EB%A6%AC%EB%88%85%EC%8A%A4/">리눅스</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/%EC%8A%A4%ED%94%84%EB%A7%81/">스프링</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-62BFFHGZ29"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-62BFFHGZ29'); }); </script>
